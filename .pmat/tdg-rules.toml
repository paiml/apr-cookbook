# PMAT Quality Gates Configuration
# Toyota Way: Jidoka - Stop the line on defects

[quality_gates]
rust_min_grade = "A"
max_score_drop = 3.0
mode = "strict"
block_on_regression = true
block_on_new_files = true

[thresholds]
test_coverage = 95
mutation_score = 80
cyclomatic_complexity = 10
entropy_threshold = 15  # Higher for cookbook (intentional patterns)
dead_code_threshold = 0.5  # Allow minimal for demo structs

[baseline]
baseline_path = ".pmat/tdg-baseline.json"
auto_update_on_main = true

[analyze]
# Files to analyze
include = ["src/**/*.rs", "examples/**/*.rs"]
exclude = ["target/**", "benches/**", "book/**"]

[quality_gate_exceptions]
# Cookbook-specific exceptions (pedagogical patterns)
entropy_violations = 10  # Allow repeated patterns in examples
provability_minimum = 30  # Lower bar for demo code
documentation_strict = false  # Allow minimal docs in examples

# Defect patterns to flag
defect_patterns = [
    "unwrap\\(\\)",
    "expect\\(",
    "panic!",
    "todo!",
    "unimplemented!",
]

# Allow these patterns in test code
test_exceptions = [
    "unwrap\\(\\)",
    "expect\\(",
]
